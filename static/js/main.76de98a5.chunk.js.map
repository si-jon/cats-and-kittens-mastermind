{"version":3,"sources":["voice.ts","dmReprompt.ts","grammars/grammar.ts","dmMastermind.ts","dmHowToPlay.ts","dmMain.ts","dmRasaQuery.ts","index.tsx"],"names":["say","text","send","_context","type","value","listen","cancel","actions","startRepromptTimer","delay","id","cancelRepromptTimer","resetRepromptCount","assign","repromptCount","context","reprompt","repromptMessage","state","initial","states","repromptCounter","entry","always","cond","target","on","ENDSPEECH","exit","done","digitGrammar","digit","yes_no_grammar","generateDigits","digits","i","push","Math","floor","random","splitDigitString","inputStr","preSplit","split","forEach","element","idx","arr","undefined","pruneStr","join","replace","console","log","Array","from","getCount","length","isValidInput","splitStr","parsed","Number","isNaN","isDigits","convertToDigits","addToHistory","guess","catCount","kittenCount","guessHistory","addCatsAndKittensHistory","cats","kittens","soughtDigits","guessedDigits","digitsResponse","availablekittens","guessesLeft","NaN","j","getCatsAndKittensMessage","catStr","kittenStr","getWinMessage","guessCount","saveDigits","recResult","dmMastermindMachine","catsnkittens","welcome","play","prompt","ask","onDone","result","tooMany","tooFew","invalid","TIMER","RECOGNISED","d","allCorrect","finished","hist","history","playprompt","common","help","quit","dmHowToPlayMachine","pre","mid","cat","kitten","sendQuery","dmMainMachine","init","CLICK","intro","nomatch","pending","RESPONSE","event","RESPONSE_ERROR","howToPlay","options","dmMastermind","error","dmRasaQueryMachine","QUERY","query","invoke","src","fetch","Request","proxyurl","method","headers","body","then","data","json","intent","name","onError","inspect","url","iframe","machine","Machine","nluData","ttsAgenda","dm","dmRasaQuery","asrtts","idle","LISTEN","SPEAK","recognising","ASRRESULT","STOP_LISTEN","progress","match","speaking","recLogResult","test","logIntent","ReactiveButton","props","matches","className","style","animation","GuessList","ghli","map","guessData","index","WinMessage","App","useSpeechSynthesis","onEnd","speak","useSpeechRecognition","onResult","stop","listening","useMachine","devTools","recStart","asEffect","interimResults","continuous","recStop","ttsStart","effect","ttsCancel","current","onClick","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.76de98a5.chunk.js","sourcesContent":["import { send, Action } from \"xstate\";\n\nexport function say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: 'SPEAK', value: text }))\n}\n\nexport function listen(): Action<SDSContext, SDSEvent> {\n    return send('LISTEN')\n}","import { MachineConfig, send, Action, assign, actions } from \"xstate\";\nimport { say } from \"./voice\";\n\nconst { cancel } = actions;\n\nexport const startRepromptTimer: Action<SDSContext, SDSEvent> = send('TIMER', { delay: 30000, id: 'repromptTimer' })\nexport const cancelRepromptTimer: Action<SDSContext, SDSEvent> = cancel('repromptTimer')\nexport const resetRepromptCount: Action<SDSContext, SDSEvent> = assign({ repromptCount: context => 0 })\n\nexport function reprompt(repromptMessage: string, state: string): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n        initial: 'reprompt',\n        states: {\n            repromptCounter: {\n                entry: [\n                    send('STOP_LISTEN'),\n                    assign({ repromptCount: context => context.repromptCount + 1 }),\n                ],\n                always: [\n                    {\n                        cond: (context) => context.repromptCount > 5,\n                        target: 'done'\n                    },\n                    {\n                        target: 'reprompt'\n                    }\n                ]\n            },\n            reprompt: {\n                entry: say(repromptMessage),\n                on: {\n                    ENDSPEECH: state,\n                },\n                exit: startRepromptTimer\n            },\n            done: {\n                type: 'final'\n            }\n        },\n    })\n}","export const digitGrammar: { [index: string]: { digit?: string } } = {\n    \"zero\": { digit: '0' },\n    \"one\": { digit: '1' },\n    \"two\": { digit: '2' },\n    \"three\": { digit: '3' },\n    \"four\": { digit: '4' },\n    \"for\": { digit: '4' },\n    \"five\": { digit: '5' },\n    \"six\": { digit: '6' },\n    \"seven\": { digit: '7' },\n    \"eight\": { digit: '8' },\n    \"nine\": { digit: '9' },\n}\n\nexport const yes_no_grammar: { [index: string]: {} } = {\n    \"yes\": true,\n    \"you bet\": true,\n    \"yeah\": true,\n    \"no\": false,\n    \"no way\": false,\n    \"nope\": false,\n}","import { MachineConfig, send, Action, assign, actions } from \"xstate\";\nimport { say, listen } from \"./voice\";\nimport { reprompt, startRepromptTimer, cancelRepromptTimer, resetRepromptCount } from \"./dmReprompt\";\nimport { digitGrammar, yes_no_grammar } from \"./grammars/grammar\"\n\nfunction generateDigits(): Array<number> {\n    let digits: Array<number> = [];\n\n    for (var i = 0; i < 4; i++) {\n        digits.push(Math.floor(Math.random() * 10));\n    }\n    return digits;\n}\n\nfunction splitDigitString(inputStr: string): Array<string> {\n    const preSplit = inputStr.split(' ');\n    preSplit.forEach((element, idx, arr) => {\n        if (digitGrammar[element] != undefined && 'digit' in digitGrammar[element]) {\n            arr[idx] = digitGrammar[element].digit || '';\n        }\n    });\n    const joinStr = preSplit.join('');\n    const pruneStr = joinStr.replace(/[^0-9]/g, '');\n    console.log(pruneStr);\n    const splitStr = Array.from(pruneStr);\n    return splitStr\n}\n\nfunction getCount(inputStr: string): number {\n    return splitDigitString(inputStr).length;\n}\n\nfunction isDigits(inputStr: string): boolean {\n    const splitStr = splitDigitString(inputStr);\n    for (let i in splitStr) {\n        const parsed = Number(splitStr[i])\n        if (isNaN(parsed)) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction isValidInput(inputStr: string): boolean {\n    return (getCount(inputStr) == 4) && isDigits(inputStr);\n}\n\nfunction convertToDigits(inputStr: string): Array<number> {\n    const splitStr = splitDigitString(inputStr);\n    var digits: Array<number> = [];\n    for (let i in splitStr) {\n        let parsed = Number(splitStr[i]);\n        digits.push(parsed);\n    }\n    return digits;\n}\n\nfunction allCorrect(soughtDigits: Array<number>, guessedDigits: string): boolean {\n    const d = convertToDigits(guessedDigits);\n    for (let i = 0; i < 4; i++) {\n        if (d[i] != soughtDigits[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction addToHistory(context: SDSContext, guess: string, catCount: number, kittenCount: number) {\n    context.guessHistory.push({\n        guess: guess,\n        catCount: catCount,\n        kittenCount: kittenCount\n    });\n}\nfunction addCatsAndKittensHistory(context: SDSContext) {\n    console.log(\"addCatsAndKittensHistory\")\n    let cats = 0;\n    let kittens = 0;\n    let soughtDigits = [...context.digits]\n    let guessedDigits = [...context.digitsResponse]\n    let availablekittens = [...soughtDigits];\n    let guessesLeft = guessedDigits;\n    for (let i = 0; i < 4; i++) {\n        if (guessedDigits[i] == soughtDigits[i]) {\n            cats += 1;\n            availablekittens[i] = NaN;\n            guessesLeft[i] = NaN;\n        }\n    }\n    for (let i = 0; i < 4; i++) {\n        if (!isNaN(guessesLeft[i])) {\n            for (let j = 0; j < 4; j++) {\n                if (!isNaN(availablekittens[j]) && (guessesLeft[i] == availablekittens[j])) {\n                    kittens += 1;\n                    guessesLeft[i] = NaN;\n                    availablekittens[j] = NaN;\n                }\n            }\n        }\n    }\n    addToHistory(context, context.digitsResponse.join(\"\"), cats, kittens);\n}\n\nfunction getCatsAndKittensMessage(context: SDSContext): string {\n    addCatsAndKittensHistory(context)\n    console.log(\"getCatsAndKittensMessage\")\n    const idx = context.guessHistory.length - 1;\n    let cats = 0;\n    let kittens = 0;\n    if (idx >= 0) {\n        cats = context.guessHistory[idx].catCount;\n        kittens = context.guessHistory[idx].kittenCount;\n    }\n    console.log(`${context.guessHistory.length}`)\n    const catStr = (cats == 1) ? \"cat\" : \"cats\";\n    const kittenStr = (kittens == 1) ? \"kitten\" : \"kittens\";\n    return `${cats} ${catStr}, ${kittens} ${kittenStr}`;\n}\n\nfunction getWinMessage(context: SDSContext): string {\n    addCatsAndKittensHistory(context);\n    const guessCount = context.guessHistory.length\n    return `Meow meow meow meow! Purrfect! You got it in ${guessCount} tries!`;\n}\n\n\nconst saveDigits: Action<SDSContext, SDSEvent> = assign((context: SDSContext) => {\n    return { digitsResponse: convertToDigits(context.recResult) }\n})\n\nexport const dmMastermindMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'catsnkittens',\n    entry: [\n        resetRepromptCount,\n        assign({ guessHistory: context => [] }),\n    ],\n    states: {\n        catsnkittens: {\n            id: 'catsnkittens',\n            initial: 'welcome',\n            states: {\n                welcome: {\n                    entry: [\n                        assign(context => { return { digits: generateDigits() } }),\n                        say(\"Let's play cats and kittens!\"),\n                    ],\n                    on: {\n                        ENDSPEECH: 'play',\n                    }\n                },\n                play: {\n                    id: 'play',\n                    initial: 'prompt',\n                    states: {\n                        prompt: {\n                            entry: say(\"Give me four digits!\"),\n                            on: {\n                                ENDSPEECH: 'ask'\n                            },\n                            exit: startRepromptTimer\n                        },\n                        ask: {\n                            entry: listen(),\n                            exit: cancelRepromptTimer\n                        },\n                        reprompt: {\n                            ...reprompt(\"You can ask me for help if you need to.\", '#play.ask'),\n                            onDone: '#done'\n                        },\n                        result: {\n                            entry: [\n                                send((context) => ({\n                                    type: \"SPEAK\",\n                                    value: getCatsAndKittensMessage(context)\n                                }))],\n                            on: {\n                                ENDSPEECH: 'prompt'\n                            }\n                        },\n                        tooMany: {\n                            entry: [\n                                (context) => (addToHistory(context, context.digitsResponse.join(\"\"), 0, 0)),\n                                say(\"That's too many digits\"),\n                            ],\n                            on: {\n                                ENDSPEECH: 'prompt',\n                            }\n                        },\n                        tooFew: {\n                            entry: [\n                                (context) => (addToHistory(context, context.digitsResponse.join(\"\"), 0, 0)),\n                                say(\"That's too few digits\"),\n                            ],\n                            on: {\n                                ENDSPEECH: 'prompt',\n                            }\n                        },\n                        invalid: {\n                            entry: [\n                                (context) => (addToHistory(context, \"<not digits>\", 0, 0)),\n                                say(\"That's not four digits\"),\n                            ],\n                            on: {\n                                ENDSPEECH: 'prompt',\n                            }\n                        }\n                    },\n                    on: {\n                        TIMER: '.reprompt.repromptCounter',\n                        RECOGNISED: [{\n                            cond: (context) => context.recResult === 'help',\n                            target: '#common.help'\n                        },\n                        {\n                            cond: (context) => context.recResult === 'quit',\n                            target: '#common.quit'\n                        },\n                        {\n                            cond: (context) => allCorrect(context.digits, context.recResult),\n                            actions: saveDigits,\n                            target: 'finished'\n                        },\n                        {\n                            cond: (context) => isValidInput(context.recResult),\n                            actions: saveDigits,\n                            target: '.result'\n                        },\n                        {\n                            cond: (context) => getCount(context.recResult) > 4,\n                            actions: saveDigits,\n                            target: '.tooMany'\n                        },\n                        {\n                            cond: (context) => getCount(context.recResult) < 4 && getCount(context.recResult) > 0,\n                            actions: saveDigits,\n                            target: '.tooFew'\n                        },\n                        {\n                            target: '.invalid'\n                        }\n                        ]\n                    }\n                },\n                finished: {\n                    entry: [\n                        send((context) => ({\n                            type: \"SPEAK\",\n                            value: getWinMessage(context)\n                        })),\n                    ],\n                    on: {\n                        ENDSPEECH: '#playprompt'\n                    }\n                },\n                hist: {\n                    type: 'history',\n                    history: 'shallow'\n                },\n            },\n        },\n        playprompt: {\n            id: 'playprompt',\n            initial: 'prompt',\n            states: {\n                prompt: {\n                    entry: say(\"Do you want to play again?\"),\n                    on: {\n                        ENDSPEECH: 'ask'\n                    },\n                    exit: startRepromptTimer\n                },\n                ask: {\n                    entry: listen(),\n                    exit: cancelRepromptTimer\n                },\n                reprompt: {\n                    ...reprompt(\"Play again?\", '#playprompt.ask'),\n                    onDone: '#done'\n                },\n            },\n            on: {\n                TIMER: '.reprompt.repromptCounter',\n                RECOGNISED: [{\n                    cond: (context) => yes_no_grammar[context.recResult] === true,\n                    actions: [\n                        assign({ guessHistory: context => [] }),\n                    ],\n                    target: 'catsnkittens'\n                },\n                {\n                    cond: (context) => yes_no_grammar[context.recResult] === false,\n                    target: 'done'\n                },\n                {\n                    target: '.prompt'\n                }\n                ]\n            }\n        },\n        common: {\n            id: 'common',\n            states: {\n                help: {\n                    entry: say(\"This is a help message\"),\n                    on: {\n                        ENDSPEECH: [\n                            {\n                                target: '#catsnkittens.hist',\n                                actions: (context: SDSContext) => {\n                                    console.log('You cheat! ' + context.digits);\n                                }\n                            }\n                        ]\n                    },\n                },\n                quit: {\n                    id: 'quit',\n                    initial: 'prompt',\n                    states: {\n                        prompt: {\n                            entry: say(\"Are you sure you want to exit the game?\"),\n                            on: {\n                                ENDSPEECH: 'ask'\n                            },\n                            exit: startRepromptTimer\n                        },\n                        ask: {\n                            entry: listen(),\n                            exit: cancelRepromptTimer\n                        },\n                        reprompt: {\n                            ...reprompt(\"Do you want to exit the game?\", '#quit.ask'),\n                            onDone: '#done'\n                        },\n                    },\n                    on: {\n                        TIMER: '.reprompt.repromptCounter',\n                        RECOGNISED: [{\n                            cond: (context) => yes_no_grammar[context.recResult] === true,\n                            target: '#done'\n                        },\n                        {\n                            cond: (context) => yes_no_grammar[context.recResult] === false,\n                            target: '#catsnkittens.hist',\n                        },\n                        {\n                            target: '.prompt'\n                        }\n                        ]\n                    }\n                }\n            },\n        },\n        done: {\n            id: 'done',\n            entry: say(\"Bye bye!\"),\n            type: 'final',\n        },\n    },\n})\n","import { MachineConfig } from \"xstate\";\nimport { say } from \"./voice\";\n\nconst preText = \"Cats and kittens is a version of the game Mastermind. \\\n    Your task is to figure out my four digit code with help of my hints.\"\n\nconst mitText = \"You guess which four digits, 0-9, are in my code, and I'll give you a hint of each guess.\\\n        The hints are the number of cats and kittens!\"\n\nconst catText = \"A cat indicates one of the numbers in your guess are in the correct spot.\"\nconst kittenText = \"A kitten indicates one of the numbers in your guess are included in the code, but in the wrong spot.\"\n\nexport const dmHowToPlayMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'pre',\n    states: {\n        pre: {\n            entry: say(preText),\n            on: { ENDSPEECH: 'mid' }\n        },\n        mid: {\n            entry: say(mitText),\n            on: { ENDSPEECH: 'cat' }\n        },\n        cat: {\n            entry: say(catText),\n            on: { ENDSPEECH: 'kitten' }\n        },\n        kitten: {\n            entry: say(kittenText),\n            on: { ENDSPEECH: 'done' }\n        },\n        done: {\n            type: 'final',\n        },\n    }\n})\n","import { MachineConfig, send, Action, assign } from \"xstate\";\nimport { dmMastermindMachine } from \"./dmMastermind\";\nimport { dmHowToPlayMachine } from \"./dmHowToPlay\";\nimport { reprompt, startRepromptTimer, cancelRepromptTimer, resetRepromptCount } from \"./dmReprompt\";\nimport { say, listen} from \"./voice\";\n\nconst sendQuery: Action<SDSContext, SDSEvent> = send((context: SDSContext) => ({\n    type: \"QUERY\", value: context.recResult\n}))\n\nconst yes_no_grammar: { [index: string]: {} } = {\n    \"yes\": true,\n    \"you bet\": true,\n    \"yeah\": true,\n    \"no\": false,\n    \"no way\": false,\n    \"nope\": false,\n}\n\nexport const dmMainMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    id: 'main',\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                CLICK: 'welcome'\n            }\n        },\n        welcome: {\n            initial: 'prompt',\n            states: {\n                prompt: {\n                    entry: say(\"Welcome to cats and kittens!\"),\n                    on: { ENDSPEECH: '#intro' },\n                },\n            }\n        },\n\t    intro: {\n            id: 'intro',\n            initial: 'prompt',\n            states: {\n                prompt: {\n                    entry: say(\"Let's play! Or I can give you some options on what to do!\"),\n                    on: { ENDSPEECH: 'ask' },\n                    exit: startRepromptTimer\n                },\n                ask: {\n                    entry: listen(),\n                    exit: cancelRepromptTimer\n                },\n                reprompt: {\n                    ...reprompt(\"I can give you some options on what to do, if you need to!\", '#intro.ask'),\n                    onDone: '#done'\n                },\n                nomatch: {\n                    entry: say(\"Sorry, I don't know how to do this.\"),\n                    on: { ENDSPEECH: 'prompt' }\n                },\n                pending: {\n                    id: 'pending',\n                    on: {\n                        RESPONSE: [\n                            {\n                                cond: (context, event) => event.value === \"play_game\",\n                                target: '#dmMastermind'\n                            },\n                            {\n                                cond: (context, event) => event.value === \"quit\",\n                                target: '#quit'\n                            },\n                            {\n                                cond: (context, event) => event.value === \"how_to_play\",\n                                target: '#howToPlay'\n                            },\n                            {\n                                cond: (context, event) => event.value === \"options\",\n                                target: '#options'\n                            },\n                            {\n                                cond: (context, event) => event.value === \"help\",\n                                target: '#help'\n                            },\n                            { target: 'nomatch' }\n                        ],\n                        RESPONSE_ERROR: {\n                            target: '#error',\n                        }\n                    }\n                },\n            },\n\t        on: {\n                TIMER: '.reprompt.repromptCounter',\n\t    \t    RECOGNISED: {\n\t    \t        actions: sendQuery,\n\t    \t        target: '.pending',\n                }\n            },\n\t    },\n        quit: {\n            id: 'quit',\n            initial: 'prompt',\n            states: {\n                prompt: {\n                    entry: say(\"Are you sure you want to exit the game?\"),\n                    on: { ENDSPEECH: 'ask' },\n                    exit: startRepromptTimer\n                },\n                ask: {\n                    id: 'ask',\n                    entry: listen(),\n                    exit: cancelRepromptTimer\n                },\n                reprompt: {\n                    ...reprompt(\"Do you want to exit the game?\", '#quit.ask'),\n                    onDone: '#done'\n                },\n                nomatch: {\n                    entry: say(\"Sorry, I didn't catch that.\"),\n                    on: { ENDSPEECH: 'prompt' }\n                },\n                pending: {\n                    id: 'pending',\n                    on: {\n                        RESPONSE: [\n                            {\n                                cond: (context, event) => event.value === \"affirm\",\n                                target: '#done'\n                            },\n                            {\n                                cond: (context, event) => event.value === \"deny\",\n                                target: '#intro'\n                            },\n                            { target: 'nomatch' }\n                        ],\n                        RESPONSE_ERROR: {\n                            target: '#error',\n                        }\n                    }\n                },\n            },\n\t        on: {\n                TIMER: '.reprompt.repromptCounter',\n\t    \t    RECOGNISED: {\n\t    \t        actions: sendQuery,\n\t    \t        target: '.pending',\n                }\n            },\n        },\n        howToPlay: {\n            id: 'howToPlay',\n            ...dmHowToPlayMachine,\n            onDone: {\n                target: 'intro'\n            }\n        },\n        options: {\n            id: 'options',\n            initial: 'prompt',\n            states: {\n                prompt: {\n                    entry: say(\"These are your options!\"),\n                    on: { ENDSPEECH: '#intro' },\n                },\n            },\n        },\n        help: {\n            id: 'help',\n            initial: 'prompt',\n            states: {\n                prompt: {\n                    entry: say(\"I'll help you!\"),\n                    on: { ENDSPEECH: '#intro' },\n                },\n            },\n        },\n        dmMastermind: {\n            id: 'dmMastermind',\n            ...dmMastermindMachine,\n            onDone: {\n                target: 'init' \n            }\n        },\n        error: {\n            id: 'error',\n            entry: say(\"Sorry, something went wrong. Maybe try again later?\"),\n            on: { ENDSPEECH: 'done' }\n        },\n        done: {\n            id: 'done',\n            entry: say(\"Bye bye!\"),\n            type: 'final',\n        },\n    },\n    onDone: {\n        target: '.init'\n    }\n})","import { MachineConfig, send, assign, Action } from \"xstate\";\n\nconst proxyurl = 'https://cors-anywhere.herokuapp.com/';\nconst rasaurl = 'https://cnk-mastermind-rasa-server.herokuapp.com/model/parse'\nconst nluRequest = (text: string) =>\n    fetch(new Request(proxyurl + rasaurl, {\n        method: 'POST',\n        headers: { 'Origin': 'https://github.com/si-jon/cats-and-kittens-mastermind' }, // only required with proxy\n        body: `{\"text\": \"${text}\"}`\n    })).then(data => data.json());\n\nexport const dmRasaQueryMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                QUERY: {\n                    actions: assign((context, event) => { return { query: event.value } }),\n                    target:'query'\n                }\n            }\n        },\n\t    query: {\n\t        invoke: {\n                src: (context, event) => nluRequest(context.query),\n                onDone: {\n                    target: 'init',\n                    actions: [\n                        send((context, event) => ({ type: \"RESPONSE\", value: event.data.intent.name })),\n                        (context:SDSContext, event:any) => console.log(event.data)\n                        ]\n                },\n\t    \t    onError: {\n                    target: 'init',\n\t    \t        actions: [\n                        send((context, event) => ({ type: \"RESPONSE_ERROR\", value: event.data })),\n                        (context:SDSContext, event:any) => console.log(event.data)\n                    ]\n                }\n            }\n\t    }\n    }\n})\n","import \"./styles.scss\";\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { Machine, assign, send, State } from \"xstate\";\nimport { useMachine, asEffect } from \"@xstate/react\";\nimport { inspect } from \"@xstate/inspect\";\nimport { dmMainMachine } from \"./dmMain\";\nimport { dmRasaQueryMachine } from \"./dmRasaQuery\";\n\n\ninspect({\n    url: \"https://statecharts.io/inspect\",\n    iframe: false\n});\n\nimport { useSpeechSynthesis, useSpeechRecognition } from 'react-speech-kit';\n\nconst initContext = {\n    recResult: \"\",\n    nluData: \"\",\n    ttsAgenda: \"\",\n    query: \"\",\n    digits: [],\n    digitsResponse: [],\n    guessHistory: [],\n    repromptCount: 0,\n}\n\nconst machine = Machine<SDSContext, any, SDSEvent>({\n    id: 'root',\n    type: 'parallel',\n    context: initContext,\n    states: {\n        dm: {\n            ...dmMainMachine\n        },\n        dmRasaQuery: {\n            ...dmRasaQueryMachine,\n        },\n        asrtts: {\n            initial: 'idle',\n            states: {\n                idle: {\n                    on: {\n                        LISTEN: 'recognising',\n                        SPEAK: {\n                            target: 'speaking',\n                            actions: assign((_context, event) => { return { ttsAgenda: event.value } })\n                        }\n                    }\n                },\n                recognising: {\n                    initial: 'progress',\n                    entry: 'recStart',\n                    exit: 'recStop',\n                    on: {\n                        ASRRESULT: {\n                            actions: ['recLogResult',\n                                assign((_context, event) => { return { recResult: event.value } })],\n                            target: '.match'\n                        },\n                        RECOGNISED: 'idle',\n                        STOP_LISTEN: 'idle'\n                    },\n                    states: {\n                        progress: {\n                        },\n                        match: {\n                            entry: send('RECOGNISED'),\n                        },\n                    }\n                },\n                speaking: {\n                    entry: 'ttsStart',\n                    on: {\n                        ENDSPEECH: 'idle',\n                    }\n                }\n            }\n        }\n    },\n},\n    {\n        actions: {\n            recLogResult: (context: SDSContext) => {\n                console.log('<< ASR: ' + context.recResult);\n            },\n            test: () => {\n                console.log('test')\n            },\n            logIntent: (context: SDSContext) => {\n                console.log('<< NLU intent: ' + context.nluData.intent.name)\n            }\n        },\n    });\n\n\n\ninterface Props extends React.HTMLAttributes<HTMLElement> {\n    state: State<SDSContext, any, any, any>;\n}\nconst ReactiveButton = (props: Props): JSX.Element => {\n    switch (true) {\n        case props.state.matches({ asrtts: 'recognising' }):\n            return (\n                <button type=\"button\" className=\"glow-on-hover\"\n                    style={{ animation: \"glowing 20s linear\" }} {...props}>\n                    Listening...\n                </button>\n            );\n        case props.state.matches({ asrtts: 'speaking' }):\n            return (\n                <button type=\"button\" className=\"glow-on-hover\"\n                    style={{ animation: \"bordering 1s infinite\" }} {...props}>\n                    Speaking...\n                </button>\n            );\n        case props.state.matches({ dmRasaQuery: 'query' }):\n            console.log('Waiting for rasa result')\n            return (\n                <button type=\"button\" className=\"glow-on-hover\"\n                    style={{ animation: \"glowing 60s linear\" }} {...props}>\n                    Waiting...\n                </button>\n            );\n        default:\n            return (\n                <button type=\"button\" className=\"glow-on-hover\" {...props}>\n                    Click to start\n                </button >\n            );\n    }\n}\n\nconst GuessList = (props: Props): JSX.Element => {\n    const history = props.state.context.guessHistory;\n    const ghli = history.map((guessData, index) => {\n        const guess = guessData.guess;\n        const catCount = guessData.catCount;\n        const kittenCount = guessData.kittenCount;\n        return (\n            <li key={index}>\n                <div className=\"guess\">{guess}</div><div className=\"hint\">&#128049;: {catCount} &#128008;: {kittenCount}</div>\n            </li>\n        );\n    });\n    return (\n        <ol className=\"guessList\">{ghli}</ol>\n    );\n}\n\nconst WinMessage = (props: Props): JSX.Element => {\n    const history = props.state.context.guessHistory;\n    const idx = history.length - 1;\n    if (idx >= 0 && history[idx].catCount === 4) {\n        return (\n            <div className=\"winMessage\">&#128568; &#128568; &#128568; &#128568;\n                Purrrrfect!\n            </div>\n        );\n    }\n    return (\n        <div></div>\n    );\n}\n\nfunction App() {\n    const { speak, cancel, speaking } = useSpeechSynthesis({\n        onEnd: () => {\n            send('ENDSPEECH');\n        },\n    });\n    const { listen, listening, stop } = useSpeechRecognition({\n        onResult: (result: any) => {\n            send({ type: \"ASRRESULT\", value: result });\n        },\n    });\n    const [current, send, service] = useMachine(machine, {\n        devTools: true,\n        actions: {\n            recStart: asEffect(() => {\n                console.log('Ready to receive speech input.');\n                listen({\n                    interimResults: false,\n                    continuous: true\n                });\n            }),\n            recStop: asEffect(() => {\n                console.log('Recognition stopped.');\n                stop()\n            }),\n            ttsStart: asEffect((context, effect) => {\n                console.log('Speaking...');\n                speak({ text: context.ttsAgenda })\n            }),\n            ttsCancel: asEffect((context, effect) => {\n                console.log('TTS STOP...');\n                cancel()\n            })\n        }\n    });\n\n    return (\n        <div className=\"background\">\n            <div className=\"Game\">\n                <h1>&#128049; Cats &amp; Kittens! &#128008;</h1>\n                <ReactiveButton state={current} onClick={() => send('CLICK')} />\n                <div id=\"lined\">\n                    <div id=\"content\">\n                        <GuessList state={current} />\n                        <WinMessage state={current} />\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n};\n\nReactDOM.render(\n    <App />,\n    document.getElementById(\"root\"));\n"],"sourceRoot":""}